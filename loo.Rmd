---
title: "Model comp"
author: "Zhengfan Wang"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## LOOCV

```{r message=FALSE, echo=FALSE, warning=FALSE}
library("rstanarm")
library("bayesplot")
library("loo")
fit.ref <- readRDS("rdsoutput/ref_qi1.rds")
fit.add1 <- readRDS("rdsoutput/add1_qi1.rds")
fit.add2 <- readRDS("rdsoutput/add2_qi1.rds")

loo.ref <- loo(fit.ref)
loo.add1 <- loo(fit.add1)
loo.add2 <- loo(fit.add2)

```


```{r warnings = FALSE,message=FALSE}
compare(loo.add1,loo.ref)
```
Here $elpd_diff-2se$ does not include zero, and the difference is postive, hence the model(cubic $I=1$) is preferred. 
```{r warnings= FALSE, message=FALSE}
compare(loo.add2,loo.ref)
```
Here $elpd_diff-2se$ does not include zero, and the difference is postive, hence the model(quadratic $I=1$) is preferred. But it seems less smooth.

Pareto k diagnostic for 4 models are listed as following, where $c2.5$ means cubic splines with interval length 2.5 years, $q1$ means quadratic splines with interval length 1 year.
```{r}
print(loo.c2.5)
print(loo.q2.5)
print(loo.c1)
print(loo.q1)



plot(loo.c2.5)
plot(loo.q2.5)
plot(loo.c1)
plot(loo.q1)

```


